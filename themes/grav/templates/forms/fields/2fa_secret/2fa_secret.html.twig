{% extends "forms/field.html.twig" %}

{% block input %}
    <div class="form-input-wrapper 2fa-wrapper">
        {% set two_fa = admin.get2FA() %}
        {% set value = (value is null ? two_fa.createSecret(160) : value) %}

        <img style="border: 1px solid #ddd" src="{{ two_fa.getQRCodeImageAsDataUri(grav.user.email, value) }}" />
        <div class="2fa-secret">{{ value|chunkSplit(4, ' ') }}</div>

        <input type="text" style="display:none;" name="{{ (scope ~ field.name)|fieldName }}" value="{{ value|join(', ') }}" />
    </div>

    <script>
        function twofaVisiblity() {
            console.log('clicked');
            if ($('#toggle_twofa_enabled1').is(':checked')) {
                console.log('checked');
                $('.twofa-secret').addClass("show");
            } else {
                console.log('unchecked');
                $('.twofa-secret').removeClass("show");
            }
        }

        $( document ).ready(function() {
            twofaVisiblity();
            $('.twofa-toggle input').click(twofaVisiblity);
        });

    </script>
{% endblock %}
